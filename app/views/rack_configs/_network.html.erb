<% network_interfaces = @rack_config.interfaces.where(interface_type: "network") %>
<% interface_groups = network_interfaces.distinct(:interface_group) %>
<% interface_groups.each do |group| %>
  <div class="col-12">
    <h3><%= group %></h3>

    <table class="table table-bordered">
      <thead>
        <tr>
          <th scope="col">U</th>
          <th scope="col">Part Number</th>
          <th scope="col">Man/Model</th>
          <th scope="col">Local Port</th>
          <th scope="col">Remote Port</th>
          <th scope="col">Type</th>
          <th scope="col">Length</th>
          <th scope="col">Color</th>
        </tr>
      </thead>

      <tbody>
        <% interface = @rack_config.interfaces.where(interface_group: group).first %>
        <% connections = interface.connections.all.sort_by { |hash| @rack_config.elevation.rack_components.find(hash[:local_device_id]).u_location } %>
        <% connections.reverse.each do |connection| %>
          <% local_device = connection.local_device %>
          <% remote_device = connection.remote_device %>
          <% part = local_device.part %>

          <% unless part.nil? %>
              <tr>
                <td><%= local_device.u_location %></td>
                <td><%= part.part_number %></td>
                <td><%= part.manufacturer %> <%= part.model %></td>
                <td><%= "U" + local_device.u_location.to_s + ":" + connection.local_port %></td>
                <td><%= "U" + remote_device.u_location.to_s + ":" + connection.remote_port %></td>
                <td><%= connection.cable_type %></td>
                <td><%= connection.cable_length %></td>
                <td><%= connection.cable_color %></td>
              </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>
