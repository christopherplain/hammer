<% power_interfaces = @rack_config.interfaces.where(interface_type: "power") %>
<% interface_groups = power_interfaces.distinct(:interface_group) %>
<% interface_groups.each do |group| %>
  <div class="col-12">
    <h3><%= group %></h3>

    <table class="table table-bordered">
      <thead>
        <tr>
          <th scope="col">U</th>
          <th scope="col">Part Number</th>
          <th scope="col">Man/Model</th>
          <th scope="col">PSU</th>
          <th scope="col">PDU Port</th>
          <th scope="col">Type</th>
          <th scope="col">Length</th>
          <th scope="col">Color</th>
        </tr>
      </thead>

      <tbody>
        <% interface = @rack_config.interfaces.where(interface_group: group).first %>
        <% connections = interface.connections.all.sort_by { |hash| hash[:local_u] } %>
        <% connections.reverse.each do |connection| %>
          <% u_location = connection.local_u %>
          <% orientation = connection.local_orientation %>
          <% component = @elevation.rack_components.where(u_location: u_location, orientation: orientation).first %>
          <% part = component.part if component %>

          <% unless part.nil? %>
              <tr>
                <td><%= u_location %></td>
                <td><%= part.part_number %></td>
                <td><%= part.manufacturer %> <%= part.model %></td>
                <td><%= "U" + connection.local_u.to_s + ":" + connection.local_port %></td>
                <td><%= group + ":" + connection.remote_port %></td>
                <td><%= connection.cable_type %></td>
                <td><%= connection.cable_length %></td>
                <td><%= connection.cable_color %></td>
              </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>
